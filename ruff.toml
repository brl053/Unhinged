# Ruff configuration for Unhinged platform
# Mozilla-grade Python static analysis configuration

# Keep cache in build directory for cleaner repo root
cache-dir = "build/.cache/ruff"

# Exclude generated files and vendored code
exclude = [
    ".git",
    ".ruff_cache",
    "build/python/venv",
    "venv-production",
    "generated",
    "__pycache__",
    "*.pyc",
    ".pytest_cache",
]

# Target Python 3.12
target-version = "py312"

# Line length - 120 is more practical for modern development
# Allows for descriptive variable names and f-strings without excessive wrapping
line-length = 120

[lint]
# Enable comprehensive rule sets
select = [
    "E",   # pycodestyle errors
    "W",   # pycodestyle warnings
    "F",   # pyflakes
    "I",   # isort
    "N",   # pep8-naming
    "UP",  # pyupgrade
    "B",   # flake8-bugbear
    "C4",  # flake8-comprehensions
    "SIM", # flake8-simplify
]

# Ignore specific rules that conflict with GTK/GObject patterns
ignore = [
    "E402",  # Module level import not at top of file - required for gi.require_version()
    "E722",  # Bare except - sometimes needed for GTK widget cleanup
]

# Allow unused variables when they start with underscore
dummy-variable-rgx = "^(_+|(_+[a-zA-Z0-9_]*[a-zA-Z0-9]+?))$"

[lint.per-file-ignores]
# Test files can have additional flexibility
"test_*.py" = ["F401", "F841"]
"**/tests/**/*.py" = ["F401", "F841"]

# Example files can have unused imports
"**/examples/**/*.py" = ["F401"]
"**/*_example.py" = ["F401"]

# __init__.py files often have unused imports for re-export
"**/__init__.py" = ["F401"]

# GTK files need E402 ignored for gi.require_version() pattern
"control/gtk4_gui/**/*.py" = ["E402"]
"control/service_launcher.py" = ["E402"]

# libcst visitor methods require specific naming (visit_ClassName)
# N802 errors are expected and required by the libcst library pattern
"cli/analysis/libcst_analyzer.py" = ["N802"]
"build/find_usages.py" = ["N802"]
"build/find_usages_recursive.py" = ["N802"]

[format]
# Use black-compatible formatting
quote-style = "double"
indent-style = "space"
line-ending = "auto"

