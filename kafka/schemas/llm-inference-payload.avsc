{
  "type": "record",
  "name": "LLMInferencePayload",
  "namespace": "com.unhinged.cdc.payload.llm",
  "doc": "LLM Inference event payload with rich rationale for AI/ML training",
  "fields": [
    {
      "name": "inference_id",
      "type": "string",
      "doc": "Unique inference identifier"
    },
    {
      "name": "model_info",
      "type": {
        "type": "record",
        "name": "ModelInfo",
        "fields": [
          {"name": "model_name", "type": "string"},
          {"name": "model_version", "type": "string"},
          {"name": "provider", "type": "string"},
          {"name": "model_type", "type": ["null", "string"], "default": null}
        ]
      },
      "doc": "Model information"
    },
    {
      "name": "prompt",
      "type": {
        "type": "record",
        "name": "PromptInfo",
        "fields": [
          {"name": "text", "type": "string"},
          {"name": "token_count", "type": "int"},
          {"name": "template_used", "type": ["null", "string"], "default": null},
          {"name": "context_window_size", "type": "int"},
          {"name": "system_prompt_included", "type": "boolean", "default": false}
        ]
      },
      "doc": "Prompt information"
    },
    {
      "name": "response",
      "type": {
        "type": "record",
        "name": "ResponseInfo",
        "fields": [
          {"name": "text", "type": "string"},
          {"name": "token_count", "type": "int"},
          {"name": "finish_reason", "type": {"type": "enum", "name": "FinishReason", "symbols": ["STOP", "LENGTH", "CONTENT_FILTER", "ERROR"]}},
          {"name": "confidence_score", "type": ["null", "double"], "default": null}
        ]
      },
      "doc": "Response information"
    },
    {
      "name": "parameters",
      "type": {
        "type": "record",
        "name": "InferenceParameters",
        "fields": [
          {"name": "temperature", "type": "double"},
          {"name": "max_tokens", "type": "int"},
          {"name": "top_p", "type": ["null", "double"], "default": null},
          {"name": "frequency_penalty", "type": ["null", "double"], "default": null},
          {"name": "presence_penalty", "type": ["null", "double"], "default": null}
        ]
      },
      "doc": "Inference parameters"
    },
    {
      "name": "rationale",
      "type": {
        "type": "record",
        "name": "InferenceRationale",
        "fields": [
          {"name": "intent", "type": "string"},
          {"name": "expected_outcome", "type": "string"},
          {"name": "reasoning_chain", "type": {"type": "array", "items": "string"}, "default": []},
          {"name": "decision_factors", "type": {"type": "array", "items": "string"}, "default": []},
          {"name": "alternatives_considered", "type": {"type": "array", "items": "string"}, "default": []},
          {"name": "risk_assessment", "type": ["null", "string"], "default": null}
        ]
      },
      "doc": "Reasoning and rationale for AI/ML training"
    },
    {
      "name": "performance",
      "type": {
        "type": "record",
        "name": "PerformanceMetrics",
        "fields": [
          {"name": "latency_ms", "type": "long"},
          {"name": "tokens_per_second", "type": "double"},
          {"name": "cost_estimate_usd", "type": ["null", "double"], "default": null},
          {"name": "memory_usage_mb", "type": ["null", "double"], "default": null}
        ]
      },
      "doc": "Performance metrics"
    },
    {
      "name": "context",
      "type": {
        "type": "record",
        "name": "InferenceContext",
        "fields": [
          {"name": "conversation_history_length", "type": "int", "default": 0},
          {"name": "rag_context_used", "type": "boolean", "default": false},
          {"name": "tool_calling_enabled", "type": "boolean", "default": false},
          {"name": "function_calls", "type": {"type": "array", "items": "string"}, "default": []},
          {"name": "context_sources", "type": {"type": "array", "items": "string"}, "default": []}
        ]
      },
      "doc": "Inference context information"
    },
    {
      "name": "outcome",
      "type": {
        "type": "record",
        "name": "InferenceOutcome",
        "fields": [
          {"name": "success", "type": "boolean"},
          {"name": "error_code", "type": ["null", "string"], "default": null},
          {"name": "error_message", "type": ["null", "string"], "default": null},
          {"name": "retry_count", "type": "int", "default": 0},
          {"name": "user_satisfaction", "type": ["null", {"type": "enum", "name": "SatisfactionLevel", "symbols": ["VERY_LOW", "LOW", "MEDIUM", "HIGH", "VERY_HIGH"]}], "default": null}
        ]
      },
      "doc": "Inference outcome and quality metrics"
    }
  ]
}
